{% extends "app/layout3.html" %}

{% block content %}
{% load staticfiles %}

<section class="style-default-bright">
    <div>
        <div class="row">
	        <div class="col-md-12">
		        <h2>学生列表 </h2>
                <br/>
	        </div><!--end .col -->
	        <div class="col-lg-12">
            	<div class="card">
				    <div class="card-body ">
		                <table class="table table-banded no-margin" id="stab">
							<thead>
								<tr>
									<th>学号</th>
				                    <th>姓名</th>
				                    <th>入学年份</th>
                                    <th>手机号码</th>
                                    <th>查看完成度</th>
                                    {% if type == '管理员' or type == '辅导员' %}
                                    <th>查看参加的活动</th>{% endif%}
                                    {% if type == '管理员' or type == '辅导员' %}
                                    <th>查看参加的课程</th>{% endif%}
								</tr>
							</thead>
							<tbody id="slist">
                                {% if list %}
                                    {% for sl in list%}
                                    <tr>
				                        <td>{{sl.student.StudentNum}}</td>
				                        <td>{{sl.student.rankName}}</td>
                                        <td>{{sl.student.year}}</td>
                                        <td>{{sl.student.phone}}</td>
                                        <td><a class="btn btn-raised" href= "/complete/{{sl.student.StudentNum}}">查看</a></td>
                                        {% if type == '管理员' or type == '辅导员' %}
                                        <td><a class="btn btn-primary" href= "javascript:void(0)" onClick="readRank({{sl.student.StudentNum}})" >查看</a></td>{% endif%}
                                        {% if type == '管理员' or type == '辅导员' %}
                                        <td><a class="btn btn-info" href= "/Lesson/list/{{sl.student.StudentNum}}" >查看</a></td>{% endif%}
                                    </tr>
                                    {% endfor %}
                                {% endif %}

                                {% if not list %}
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td><i>暂时没有记录</i></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                {% endif %}
							</tbody>
						</table>
                    </div>
                </div>
	        </div><!--end .col -->
        </div>

        {#<hr class="ruler-xl">#}
        <table class="table table-banded no-margin" id="mtab">
		    <thead>
			<tr>
				<th>活动类型</th>
				<th>活动名称</th>
                <th>查看活动详细信息</th>
			</tr>
		    </thead>
            <tbody id="mainlist">

            </tbody>
	    </table>
    </div>
</section>

{% endblock %}

{% block jscript %}

<script>
    dic = new Array();
    {%for sl in list%}
        var rl = [];
        {%for r in sl.rl%}
        rl.push(new RL("{{r.name}}","{{r.project.rankName}}",{{r.ranklink.id}}));
        {%endfor%}
        dic["{{sl.student.StudentNum}}"] = rl;
    {%endfor%}
    
    function readRank(id) {
    list = dic[id.toString()]

    tab = document.getElementById("mtab");
    var num = tab.rows.length;
    if(num >1 )//清除表格
        {
        for(var i=1;i<num;i++){                           
        tab.deleteRow(1);
        }}
    for(var i = 0;i<list.length;i++){

    var tr = document.createElement("tr");  
    var new_obj = list[i];

    var tdn = document.createElement("td");  
    tdn.innerHTML = new_obj.name;
    var tdrn = document.createElement("td");  
    tdrn.innerHTML = new_obj.rankName;
    var tdadd = document.createElement("td");  
    tdadd.innerHTML = "<a class='btn btn-info' href= '/Detail/" + new_obj.id.toString() + "'>查看</a>";
    
    tr.appendChild(tdn); 
    tr.appendChild(tdrn);
    tr.appendChild(tdadd); 

    var listbody = document.getElementById("mainlist");  
    listbody.appendChild(tr);  
        }
    }
    function SL(s,sc,rl) {
        this.student = s;
        this.scores = sc;
        this.rl = rl
    }
    function RL(name,project,link) {
        this.name = name;
        this.rankName = project;
        this.id = link;
    }
</script>
<script src="{%static 'app/assets/js/libs/jquery-validation/dist/jquery.validate.min.js'%}"></script>
<script src="{%static 'app/assets/js/libs/jquery-validation/dist/additional-methods.min.js'%}"></script>
<script src="{%static 'app/assets/js/libs/wizard/jquery.bootstrap.wizard.min.js'%}"></script>
<script src="{%static 'app/assets/js/libs/DataTables/jquery.dataTables.min.js'%}"></script>

<script src="{%static 'app/assets/js/libs/DataTables/extensions/ColVis/js/dataTables.colVis.min.js'%}"></script>
<script src="{%static 'app/assets/js/libs/DataTables/extensions/TableTools/js/dataTables.tableTools.min.js'%}"></script>
<script src="{%static 'app/assets/js/core/demo/DemoFormComponents.js'%}"></script>

<script src="{%static 'app/assets/js/core/demo/DemoFormWizard.js'%}"></script>
<script src="{%static 'app/assets/js/core/demo/DemoUIMessages.js'%}"></script>

{% endblock %}

{%block css%}
<link type="text/css" rel="stylesheet" href="{%static 'app/assets/css/theme-5/libs/wizard/wizard.css'%}" />
<link type="text/css" rel="stylesheet" href="{%static 'app/assets/css/theme-5/libs/DataTables/jquery.dataTables.css'%}"/>
<link type="text/css" rel="stylesheet" href="{%static 'app/assets/css/theme-5/libs/DataTables/extensions/dataTables.colVis.css'%}" />
<link type="text/css" rel="stylesheet" href="{%static 'app/assets/css/theme-5/libs/DataTables/extensions/dataTables.tableTools.css'%}" />

{%endblock%}